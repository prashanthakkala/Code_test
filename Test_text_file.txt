import pdfplumber
import pandas as pd

# Function to extract tables from PDF and convert to HTML
def pdf_to_html_with_tables(pdf_path, output_html_path):
    # Open the PDF file
    with pdfplumber.open(pdf_path) as pdf:
        html_content = "<html>\n<head>\n<title>PDF to HTML</title>\n</head>\n<body>\n"
        
        # Iterate through each page
        for page_num, page in enumerate(pdf.pages):
            html_content += f"<h2>Page {page_num + 1}</h2>\n"
            
            # Extract text (if needed)
            text = page.extract_text()
            if text:
                html_content += f"<pre>{text}</pre>\n"
            
            # Extract tables
            tables = page.extract_tables()
            if tables:
                for table_num, table in enumerate(tables):
                    df = pd.DataFrame(table[1:], columns=table[0])  # Convert the table to a DataFrame
                    html_content += f"<h3>Table {table_num + 1}</h3>\n"
                    html_content += df.to_html(index=False, header=True)  # Convert DataFrame to HTML
                    
        html_content += "</body>\n</html>"

    # Write the HTML content to the output file
    with open(output_html_path, 'w', encoding='utf-8') as html_file:
        html_file.write(html_content)

# Example usage
pdf_path = "sample_with_tables.pdf"
output_html_path = "output_with_tables.html"
pdf_to_html_with_tables(pdf_path, output_html_path)
print(f"HTML file with tables saved as {output_html_path}")
