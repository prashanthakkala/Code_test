import fitz  # PyMuPDF

def remove_yellow_annotations(pdf_path, output_path):
    pdf = fitz.open(pdf_path)

    # Iterate through each page
    for page_num in range(pdf.page_count):
        page = pdf.load_page(page_num)
        
        # Iterate through annotations on the page
        annotations = page.annots()
        if annotations:
            for annot in annotations:
                # Check if annotation is a highlight
                if annot.type[0] == 8:  # Highlight annotation
                    fill_color = annot.colors.get("fill")
                    stroke_color = annot.colors.get("stroke")
                    
                    # Define yellow color
                    yellow = (1.0, 1.0, 0.0)  # RGB for yellow
                    
                    # Check if fill or stroke color is yellow
                    if fill_color == yellow or stroke_color == yellow:
                        page.delete_annot(annot)  # Remove annotation

    # Save the modified PDF
    pdf.save(output_path)
    pdf.close()

# Example usage
pdf_path = "your_file.pdf"
output_path = "output_no_yellow_annotations.pdf"
remove_yellow_annotations(pdf_path, output_path)
