import pdfplumber

def process_pdf(pdf_path):
    with pdfplumber.open(pdf_path) as pdf:
        for page_number, page in enumerate(pdf.pages, start=1):
            # Extract lines from the page
            lines = page.lines
            # Extract tables from the page
            tables = page.extract_tables()

            if tables:
                for table_number, table in enumerate(tables, start=1):
                    print(f"Page {page_number}, Table {table_number}:")
                    for row in table:
                        print(row)
                    
                    # Check if the end horizontal line is missing
                    last_row_y = table[-1][2] if table[-1][2] else None
                    horizontal_lines = [line for line in lines if line['top'] == last_row_y]

                    if not horizontal_lines:
                        print(f"End horizontal line is missing after table {table_number} on page {page_number}")

            else:
                print(f"No tables found on page {page_number}")

# Replace 'your_pdf.pdf' with your actual PDF file path
process_pdf('your_pdf.pdf')
