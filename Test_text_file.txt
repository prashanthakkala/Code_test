import fitz  # PyMuPDF

def remove_yellow_highlights(pdf_path, output_pdf):
    # Open the PDF
    pdf = fitz.open(pdf_path)

    # Iterate through each page
    for page_num in range(pdf.page_count):
        page = pdf.load_page(page_num)
        # Get all annotations (includes highlights, etc.)
        annotations = page.annots()

        if annotations:
            for annot in annotations:
                # Check if the annotation is a highlight
                if annot.type[0] == 8:  # Type 8 is a highlight
                    color = annot.colors['stroke']
                    # Check if it's yellow (RGB approx for yellow is (1, 1, 0))
                    if color and color == [1.0, 1.0, 0.0]:
                        page.delete_annot(annot)  # Remove the highlight

    # Save the modified PDF
    pdf.save(output_pdf)
    pdf.close()

# Example usage:
pdf_path = "your_file.pdf"
output_pdf = "output_no_yellow_highlight.pdf"
remove_yellow_highlights(pdf_path, output_pdf)
