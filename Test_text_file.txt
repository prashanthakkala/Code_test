import pdfplumber
import pandas as pd

# Path to your PDF file
pdf_path = 'your_file.pdf'

# Initialize an empty DataFrame
all_tables = pd.DataFrame()

# Open the PDF file
with pdfplumber.open(pdf_path) as pdf:
    for page_num, page in enumerate(pdf.pages, start=1):
        # Extract tables from the page
        tables = page.extract_tables()
        
        # Extract text from the bottom of the page
        # Adjust bbox (bounding box) as needed; here it is set to bottom 10% of the page
        bottom_bbox = (0, 0.9 * float(page.height), float(page.width), float(page.height))
        bottom_text = page.within_bbox(bottom_bbox).extract_text().strip()
        
        # Split the bottom text into separate strings (assuming strings are separated by newlines)
        bottom_strings = bottom_text.split('\n')
        
        # Iterate over each table
        for table in tables:
            # Convert the table to a DataFrame
            df = pd.DataFrame(table)
            
            # Add each string from bottom text as a new row at the end of the DataFrame
            for string in bottom_strings:
                bottom_row = pd.DataFrame([[string] + [''] * (len(df.columns) - 1)], columns=df.columns)
                df = pd.concat([df, bottom_row], ignore_index=True)
            
            # Add a column for the page number
            df['Page Number'] = page_num
            
            # Append the DataFrame to the all_tables DataFrame
            all_tables = pd.concat([all_tables, df], ignore_index=True)

# Display the combined DataFrame
print(all_tables)
