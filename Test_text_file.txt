import ocrmypdf

def convert_to_searchable_pdf(input_pdf_path, output_pdf_path, tesseract_path=None):
    """
    Converts a scanned PDF into a searchable and extractable PDF using OCR.

    :param input_pdf_path: Path to the input scanned PDF file.
    :param output_pdf_path: Path to save the output searchable PDF file.
    :param tesseract_path: Path to the Tesseract OCR executable (optional).
    """
    try:
        # Set the Tesseract path if provided
        if tesseract_path:
            ocrmypdf.configure(tesseract_cmd=tesseract_path)

        # Run OCRmyPDF to convert the scanned PDF into a searchable PDF
        ocrmypdf.ocr(input_pdf_path, output_pdf_path, deskew=True, optimize=3)
        print(f"Successfully converted {input_pdf_path} to a searchable PDF: {output_pdf_path}")
    except Exception as e:
        print(f"An error occurred: {e}")

# Example usage
input_pdf = "scanned_document.pdf"  # Replace with your input PDF file path
output_pdf = "searchable_document.pdf"  # Replace with your desired output PDF file path
tesseract_path = r"C:\Program Files\Tesseract-OCR\tesseract.exe"  # Replace with your Tesseract path

convert_to_searchable_pdf(input_pdf, output_pdf, tesseract_path)
